<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!--

 db-2012-04-17.xml

 Copyright (c) 2011-2012, Daniel Ellermann

 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->


<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
  <changeSet author="d.ellermann@amc-world.de" id="20120417-1">
    <addForeignKeyConstraint baseColumnNames="organization_id"
      baseTableName="calendar_event" constraintName="FK2A9BEA598466B320"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="organization"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="owner_id"
      baseTableName="calendar_event" constraintName="FK2A9BEA59DC0B6238"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="user_data"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-2">
    <addForeignKeyConstraint baseColumnNames="user_id"
      baseTableName="google_data_sync_status" constraintName="FK7A34DA477024B220"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="user_data"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-3">
    <addForeignKeyConstraint baseColumnNames="invoicing_transaction_id"
      baseTableName="invoicing_item" constraintName="FKCF5EC5886BC3566B"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="invoicing_transaction"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-4">
    <addForeignKeyConstraint baseColumnNames="carrier_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9257B68B4"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="credit_memo_stage_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC913DBA780"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="dunning_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC99346B214"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="invoicing_transaction"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="dunning_stage_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC92B8F89DD"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="invoice_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9BB290094"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="invoicing_transaction"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="invoice_stage_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9CEECCCE5"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="level_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9354E73CF"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="organization_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC98466B320"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="organization"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="payment_method_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9F806AF41"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="person_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9F1C1460"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="person"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="quote_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC96FB140B4"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="invoicing_transaction"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="quote_stage_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9E696B207"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="sales_order_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9A91976E7"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="invoicing_transaction"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="so_stage_id"
      baseTableName="invoicing_transaction" constraintName="FK44B5CAC9C4EFC2F5"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-5">
    <addForeignKeyConstraint
      baseColumnNames="invoicing_transaction_terms_and_conditions_id"
      baseTableName="invoicing_transaction_terms_and_conditions"
      constraintName="FKC357738EAA3A3B86" deferrable="false"
      initiallyDeferred="false" referencedColumnNames="id"
      referencedTableName="invoicing_transaction"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="terms_and_conditions_id"
      baseTableName="invoicing_transaction_terms_and_conditions"
      constraintName="FKC357738E61189250" deferrable="false"
      initiallyDeferred="false" referencedColumnNames="id"
      referencedTableName="sel_value" referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-6">
    <addForeignKeyConstraint baseColumnNames="user_id"
      baseTableName="lru_entry" constraintName="FKA43D4FE27024B220"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="user_data"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-7">
    <addForeignKeyConstraint baseColumnNames="organization_id"
      baseTableName="note" constraintName="FK33AFF28466B320" deferrable="false"
      initiallyDeferred="false" referencedColumnNames="id"
      referencedTableName="organization" referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="person_id"
      baseTableName="note" constraintName="FK33AFF2F1C1460" deferrable="false"
      initiallyDeferred="false" referencedColumnNames="id"
      referencedTableName="person" referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-8">
    <addForeignKeyConstraint baseColumnNames="industry_id"
      baseTableName="organization" constraintName="FK4644ED33BCD40240"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="rating_id"
      baseTableName="organization" constraintName="FK4644ED33F3FD0F60"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="type_id"
      baseTableName="organization" constraintName="FK4644ED3359B47A78"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-9">
    <addForeignKeyConstraint baseColumnNames="user_id"
      baseTableName="panel" constraintName="FK6580A047024B220"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="user_data"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-10">
    <addForeignKeyConstraint baseColumnNames="organization_id"
      baseTableName="person" constraintName="FKC4E39B558466B320"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="organization"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="salutation_id"
      baseTableName="person" constraintName="FKC4E39B55DD23A680"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-11">
    <addForeignKeyConstraint baseColumnNames="organization_id"
      baseTableName="phone_call" constraintName="FK93412A8F8466B320"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="organization"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="person_id"
      baseTableName="phone_call" constraintName="FK93412A8FF1C1460"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="person"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-12">
    <addForeignKeyConstraint baseColumnNames="category_id"
      baseTableName="product" constraintName="FKED8DCCEFE9949B03"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="tax_rate_id"
      baseTableName="product" constraintName="FKED8DCCEFC7AFB16B"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="unit_id"
      baseTableName="product" constraintName="FKED8DCCEF67D5AB80"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-13">
    <addForeignKeyConstraint baseColumnNames="organization_id"
      baseTableName="project" constraintName="FKED904B198466B320"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="organization"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="person_id"
      baseTableName="project" constraintName="FKED904B19F1C1460"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="person"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="status_id"
      baseTableName="project" constraintName="FKED904B192B4AEB6D"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-14">
    <addForeignKeyConstraint baseColumnNames="project_id"
      baseTableName="project_item" constraintName="FK37FBF0794C82E914"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="project"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-15">
    <addForeignKeyConstraint baseColumnNames="payment_method_id"
      baseTableName="purchase_invoice" constraintName="FK5ABE5DEFF806AF41"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="stage_id"
      baseTableName="purchase_invoice" constraintName="FK5ABE5DEFA555D5B4"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="vendor_id"
      baseTableName="purchase_invoice" constraintName="FK5ABE5DEFF49B86EB"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="organization"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-16">
    <addForeignKeyConstraint baseColumnNames="invoice_id"
      baseTableName="purchase_invoice_item" constraintName="FKFBF6336329E58653"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="purchase_invoice"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-17">
    <addForeignKeyConstraint baseColumnNames="calendar_event_id"
      baseTableName="reminder" constraintName="FKE116C072DCB8B137"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="calendar_event"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="user_id"
      baseTableName="reminder" constraintName="FKE116C0727024B220"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="user_data"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-18">
    <addForeignKeyConstraint baseColumnNames="category_id"
      baseTableName="service" constraintName="FK7643C6B52A2F6EC9"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-19">
    <addForeignKeyConstraint baseColumnNames="tax_rate_id"
      baseTableName="service" constraintName="FK7643C6B5C7AFB16B"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
    <addForeignKeyConstraint baseColumnNames="unit_id"
      baseTableName="service" constraintName="FK7643C6B567D5AB80"
      deferrable="false" initiallyDeferred="false"
      referencedColumnNames="id" referencedTableName="sel_value"
      referencesUniqueColumn="false" />
  </changeSet>

  <changeSet author="d.ellermann@amc-world.de" id="20120417-20">
    <createIndex indexName="subject" tableName="calendar_event">
      <column name="subject" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-21">
    <createIndex indexName="name" tableName="config">
      <column name="name" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-22">
    <createIndex indexName="deleted" tableName="google_data_sync_status">
      <column name="deleted" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-23">
    <createIndex indexName="subject" tableName="invoicing_transaction">
      <column name="subject" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-24">
    <createIndex indexName="item_id" tableName="ldap_sync_status">
      <column name="item_id" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-25">
    <createIndex indexName="title" tableName="note">
      <column name="title" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-26">
    <createIndex indexName="name" tableName="organization">
      <column name="name" />
    </createIndex>
    <createIndex indexName="rec_type" tableName="organization">
      <column name="rec_type" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-27">
    <createIndex indexName="panel_id" tableName="panel">
      <column name="panel_id" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-28">
    <createIndex indexName="first_name" tableName="person">
      <column name="first_name" />
    </createIndex>
    <createIndex indexName="last_name" tableName="person">
      <column name="last_name" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-29">
    <createIndex indexName="subject" tableName="phone_call">
      <column name="subject" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-30">
    <createIndex indexName="name" tableName="product">
      <column name="name" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-31">
    <createIndex indexName="subject" tableName="purchase_invoice">
      <column name="subject" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-32">
    <createIndex indexName="controller_name" tableName="seq_number">
      <column name="controller_name" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-33">
    <createIndex indexName="name" tableName="service">
      <column name="name" />
    </createIndex>
  </changeSet>
  
  <changeSet author="d.ellermann@amc-world.de" id="20120417-34">
    <createIndex indexName="settings_idx" tableName="user_data_settings">
      <column name="settings" />
    </createIndex>
  </changeSet>
</databaseChangeLog>
